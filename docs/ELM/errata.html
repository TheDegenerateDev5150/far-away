<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>Errata for ELM</title>
</head>

<body>
<h1>Errata for <i>Extending the Linear Model with R</i></h1>

If you find any errors not reported below, please let me know.

<h2>First Printing</h2>
<ul>
  <li>v. - Book website is now <tt>people.bath.ac.uk/jjf23/ELM</tt></li>
  <li>p27 - clarification: the log-likelihood is given for the logit.
</li>
<li>p29 - last paragraph: n-s degrees of freedom not n-l</li>
<li>p30 - first displayed equation: right curly brace missing</li>
<li>p40 - the <tt>brlr</tt> package has been superceded by the
<tt>brglm</tt> package. Also replace the  <tt>brlr()</tt> function
call with <tt>brglm()</tt></li>
<li>p41 - Nagelkerke (not Naglekerke). Nagelkerke R2 is only suitable for (ungrouped) binary response
models. It could be redefined for use in the grouped case (as in the
bliss example) but using proportion of deviance explained is a simpler
choice to understand and explain to others. This proportion for the
example is:
<pre>
> 1-modl$deviance/modl$null.deviance
[1] 0.99415
</pre></li>
<li>p44 - missing parentheses in second displayed equation &shy; should be
 (1+(k-1)tau^2)mp(1-p)</li>
 <li>p52 - Q2 dataset is <tt>wbca</tt> not <tt>wbcd</tt></li>
<li>p55 - Definition of the Poisson distribution - should be exp(-mu)
in the first formula, not exp(mu).</li>
<li>p57 - third displayed equation. Differentiating wrt beta_j gives... 
\sum (y_i - \exp(x_i^T \hat\beta)) x_{ij} = 0 (where x_ij refers to the jth element
  of vector x_i)
<li>p64 - second displayed equation: the second sum should go up to y_{i} - 1 ,
      not y_{i-1}<li>
<li>p65 - Note that the negative binomial fits use a log link.
<li>p71 - second para should read: "By examining the coefficients, we see
that wafers <i>without</i> particles occur at a significantly higher
rate than wafers <i>with</i> particles. Similarly, we see that
<i>good</i>-quality wafers occur at a significantly higher
rate than <i>bad</i>-quality wafers."</li>
<li>p74 - 3 lines from bottom: "log" should be omitted.</li>
<li>p78 - this plot make come out in a reflected form depending on the
computer you are using due to the indeterminacy of the directions of
the singular vectors. The interpretation is not affected.</li>
<li>p88 - 2 lines from bottom: "can be extracted"</li>
<li>p85 - "...age is jointly independent <i>of</i> smoking ..."</li>
<li>p86 - line 6, should be "... all three two-way interactions".</li>
<li>p86 - mid-page. The odds-ratio is 1.5333, not the log odds-ratio.</li>
<li>p94 - Q10 dataset is <tt>UCBAdmissions</tt> not <tt>UCBadmissions</tt></li>
<li>p102 - bottom "...can be viewed as a GLM-type..."</li>
<li>p112 - 3 lines from top: Unfortunately, the hazards are not proportional. An analogy
to the second equation on p108 can be made, but then it would be log(1-gamma) that is
proportional which is not the hazard in this case. The name of proportional hazards arises because
the model is defined by analogy with a continuous response proportional hazards as
commonly used in survival analysis, where the proportionality does indeed hold.</li>
<li>p115 - "...we are able to tackle..."</li>
<li>p121 - Subscript i's are missing in Table 6.2 for the Gamma and Inverse
Gaussian distribution.</li>
<li>p124 - Spelling is jackknife not jacknife (and elsewhere)</li>
<li>p125 - First formula, the square root applies to the remainder of the term.</li>
<li>p141 - line 10, The SD for lognormal is incorrectly set. It should be
<tt>sdlog=sqrt(0.61102)</tt></li>
<li>p146 - <tt>gmod <- glm(d ~ Method+Preheating..</tt> should be <tt>gmod <- glm(d ~ Material+Preheating..</tt></li>
<li>p156 - "...standard errors can be obtained..."</li>
<li>p156 - End of second paragraph should read: "The idea is to find all independent linear combinations of the response, $k$, such that $k^T X = 0$. Form matrix $K$ with
columns $k$ then $K^T y ...."</li>
<li>p156 and following: The <tt>lme4</tt> package (and the underlying
<tt>Matrix</tt> package)
has been changing since the preparation
of the book. Some differences may be observed between the current version and
that used in the book.  In
particular, recent versions of <tt>summary()</tt> and <tt>anova()</tt> of
<tt>lmer()</tt>-produced models now
do not contain p-values. Please
  <a href="mixchange.pdf">read about changes</a> to these two chapters
  to address this as well as some discussion of other inferential methods
  that could be used.
</li>
<li>p158 - "...this is a real concern..."</li>
<li>p161 - last but one displayed equation should have an alpha<sub>i</sub>
rather than an a<sub>i</sub> </li>
<li>p180 - last para, Scheff&eacute; not Scheffe&eacute;</li>
  <li>p181 - Q4a degrees of freedom are no longer output so 
    question is not meaningful.
<li>p186 - To produce a corrected version of Figure 9.2, use:
<pre>
xyplot(log(income+100) ~ year | sex, psid, type="l", groups=person)
</pre>
</li>
<li>p190 - second para, the standard deviations for the intercept and slope are 0.531 and 0.049. The residual SD is 0.684 not 0.46. (Numbers given are actually the variances)</li>
<li>p198 - first line 6.3% not 6.5% (twice)</li>
<li>p198 - line 4, 0.0179 should be 0.0174 (twice)</li>
<li>p198 One cannot see that the math scores are less variable than
the english scores using the printed output. This effect is, however, visible
in Figure 9.9.</li>
<li>p205 second para - "...the estimates for the GEE are about half
the size.."</li>
<li>p212 (and following) - the variable name <tt>duration</tt> in the
<tt>faithful</tt> dataset has changed to <tt>eruptions</tt>. It still
represents the duration of the eruption. </li>
<li>p215 - completely. (missing .)</li>
<li>p223 - should be "They are also orthonormal,.."
<li>p223 - The <tt>wavethresh</tt> package has been extensively
updated. Some changes are necessary to achieve the same output</li>
<li>p224 - The plots are now obtained by:
<pre>
wds <- wd(exa$y,filter.number=1,bc="interval")
draw(filter.number=1,family="DaubExPhase")
</pre>
</li>
<li>
p225 - last block of code should now be:
<pre>
wds <- wd(exa$y,filter.number=2,bc="interval")
draw(filter.number=2,family="DaubExPhase")
plot(wds)
</pre>
</li>
<li>p231 - line 13, should be "variables"
<li>p235 <tt>summary(ammgcv)</tt> is missing (needed to get output seen)</li>
<li>p248-249 Using <tt>> summary(lm(ozone[,1] ~ a$x[,-1])) </tt> for the three
regression summaries gives the correct R<sup>2</sup>. These are more
in line with previous models. The printed version is incorrect because
these are calculated by R assuming there is no intercept when in fact
this is already included in the X-matrix. The newly available R
package, <tt>earth</tt>, provides a much better interface to mars</li>
<li>p250 - line 6, use <tt>predict</tt> not <tt>predict.mars</tt></li>
<li>p254 - line 12, ordered factor (not factors)</li>
<li>p255 - better to say "from 21,115 to 4114+5478 = 9592" for accuracy
<li>p259 - Should use <tt>plotcp(roze)</tt> for consistency with output on p258
<li>p259 - <tt>post(roz,digits=3,filename="")</tt> is better since it ensures
  that the display uses 3 significant digits for the node means.</li>
<li>p261 - The entropy definition should not contain the 2.</li>
<li>p261 - Rijksmuseum van Natuurlijke <i>Historie</i></li>
<li>p265 - Last para, should be <tt>xerror</tt> not <tt>rel error</tt> 
<li>p282 - First displayed equation. LRT is minus the value
given.</li>
<li>p287 - the <tt>brlr</tt> package has been superceded by the
<tt>brglm</tt> package.</li>
<li>p293 - Nagelkerke (not Naglekerke) </li>
<li>p294 - Scheff&eacute; not Scheffe&eacute;</li>
</ul>

<h2>Second printing</h2>

<ul>
  <li>p26 - Just below 2.2 section heading, replace n<sub>i</sub> with
  n</li> Note that n refers to the number of observed responses while
  n<sub>i</sub> refers to the binomial sample size (e.g. no. of
  trials) for each Y<sub>i</sub>. 
  <li>p56 - In the Galapagos data, the species are of plants not
  tortoises
  <li> p191 - line 5, should read "...used a fixed effect, putting
<tt>eye</tt> in place of..."
<li>p220 - below figure - "adaptively" not adaptive
<li>p233 - midpage, should read "..using a Gaussian.."
<li>p116 - second two equations are missing a closing parenthesis
</ul>

<hr>
</body> </html>
